FROM node:18-alpine

WORKDIR /app

# Create directory structure
RUN mkdir -p /app/data

# Copy package files and install dependencies
COPY json-server/package*.json ./
RUN npm install

# Copy server code
COPY json-server/server.js ./
COPY db.json ./data/db.json

# Set permissions
RUN chown -R node:node /app
USER node

EXPOSE 3001

CMD ["npm", "start"]
